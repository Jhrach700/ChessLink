const chaincontractConfig = {
  address: "0xe007Cf9cB55F9b368067cB5d22a6B9a8A8453032",
  abi: [
    {
      "inputs": [
        {
          "internalType": "string",
          "name": "_url",
          "type": "string"
        },
        {
          "internalType": "string",
          "name": "_path",
          "type": "string"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "id",
          "type": "bytes32"
        }
      ],
      "name": "ChainlinkCancelled",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "id",
          "type": "bytes32"
        }
      ],
      "name": "ChainlinkFulfilled",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "id",
          "type": "bytes32"
        }
      ],
      "name": "ChainlinkRequested",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "bytes32",
          "name": "requestId",
          "type": "bytes32"
        },
        {
          "indexed": true,
          "internalType": "bytes",
          "name": "data",
          "type": "bytes"
        }
      ],
      "name": "RequestFulfilled",
      "type": "event"
    },
    {
      "inputs": [],
      "name": "data",
      "outputs": [
        {
          "internalType": "bytes",
          "name": "",
          "type": "bytes"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "bytes32",
          "name": "requestId",
          "type": "bytes32"
        },
        {
          "internalType": "bytes",
          "name": "bytesData",
          "type": "bytes"
        }
      ],
      "name": "fulfillBytes",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "image_url",
      "outputs": [
        {
          "internalType": "string",
          "name": "",
          "type": "string"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "requestBytes",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
bytecode: "0x608060405260016004553480156200001657600080fd5b5060405162001e5738038062001e5783398181016040528101906200003c919062000276565b6200006173a36085f69e2889c224210f603d836748e7dc0088620000c060201b60201c565b6200008673c57b33452b4f7bb189bb5afae9cc4aba1f7a4fd86200010460201b60201c565b81600890805190602001906200009e92919062000148565b508060099080519060200190620000b792919062000148565b5050506200047f565b80600260006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b80600360006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555050565b828054620001569062000390565b90600052602060002090601f0160209004810192826200017a5760008555620001c6565b82601f106200019557805160ff1916838001178555620001c6565b82800160010185558215620001c6579182015b82811115620001c5578251825591602001919060010190620001a8565b5b509050620001d59190620001d9565b5090565b5b80821115620001f4576000816000905550600101620001da565b5090565b60006200020f620002098462000324565b620002fb565b9050828152602081018484840111156200022e576200022d6200045f565b5b6200023b8482856200035a565b509392505050565b600082601f8301126200025b576200025a6200045a565b5b81516200026d848260208601620001f8565b91505092915050565b6000806040838503121562000290576200028f62000469565b5b600083015167ffffffffffffffff811115620002b157620002b062000464565b5b620002bf8582860162000243565b925050602083015167ffffffffffffffff811115620002e357620002e262000464565b5b620002f18582860162000243565b9150509250929050565b6000620003076200031a565b9050620003158282620003c6565b919050565b6000604051905090565b600067ffffffffffffffff8211156200034257620003416200042b565b5b6200034d826200046e565b9050602081019050919050565b60005b838110156200037a5780820151818401526020810190506200035d565b838111156200038a576000848401525b50505050565b60006002820490506001821680620003a957607f821691505b60208210811415620003c057620003bf620003fc565b5b50919050565b620003d1826200046e565b810181811067ffffffffffffffff82111715620003f357620003f26200042b565b5b80604052505050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b6119c8806200048f6000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c806311411e8a1461005157806373d4a13a1461005b578063824f4baf14610079578063c2fb852314610097575b600080fd5b6100596100b3565b005b6100636102b3565b60405161007091906112a1565b60405180910390f35b610081610341565b60405161008e91906112c3565b60405180910390f35b6100b160048036038101906100ac9190610fec565b6103cf565b005b60007f37613937666638343933656334303664393036323162323533316639323531619050600067016345785d8a0000905060006100f9833063c2fb852360e01b61054f565b90506101cf6040518060400160405280600381526020017f67657400000000000000000000000000000000000000000000000000000000008152506008805461014190611709565b80601f016020809104026020016040519081016040528092919081815260200182805461016d90611709565b80156101ba5780601f1061018f576101008083540402835291602001916101ba565b820191906000526020600020905b81548152906001019060200180831161019d57829003601f168201915b5050505050836105809092919063ffffffff16565b6102a36040518060400160405280600481526020017f70617468000000000000000000000000000000000000000000000000000000008152506009805461021590611709565b80601f016020809104026020016040519081016040528092919081815260200182805461024190611709565b801561028e5780601f106102635761010080835404028352916020019161028e565b820191906000526020600020905b81548152906001019060200180831161027157829003601f168201915b5050505050836105809092919063ffffffff16565b6102ad81836105b3565b50505050565b600680546102c090611709565b80601f01602080910402602001604051908101604052809291908181526020018280546102ec90611709565b80156103395780601f1061030e57610100808354040283529160200191610339565b820191906000526020600020905b81548152906001019060200180831161031c57829003601f168201915b505050505081565b6007805461034e90611709565b80601f016020809104026020016040519081016040528092919081815260200182805461037a90611709565b80156103c75780601f1061039c576101008083540402835291602001916103c7565b820191906000526020600020905b8154815290600101906020018083116103aa57829003601f168201915b505050505081565b816005600082815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610471576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161046890611305565b60405180910390fd5b6005600082815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff0219169055807f7cc135e0cebb02c3480ae5d74d377283180a2601f8f644edf7987b009316c63a60405160405180910390a2816040516104e2919061119b565b6040518091039020837f1a111c5dcf9a71088bd5e1797fdfaf399fec2afbb24aca247e4e3e9f4b61df9160405160405180910390a3816006908051906020019061052d929190610d6e565b506006600790805461053e90611709565b610549929190610df4565b50505050565b610557610e81565b61055f610e81565b610576858585846105ea909392919063ffffffff16565b9150509392505050565b61059782846080015161069a90919063ffffffff16565b6105ae81846080015161069a90919063ffffffff16565b505050565b60006105e2600360009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1684846106bf565b905092915050565b6105f2610e81565b61060285608001516101006106df565b508385600001818152505082856020019073ffffffffffffffffffffffffffffffffffffffff16908173ffffffffffffffffffffffffffffffffffffffff16815250508185604001907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191690817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191681525050849050949350505050565b6106a78260038351610749565b6106ba818361088e90919063ffffffff16565b505050565b60006106d68484846002636de879d660e01b6108b0565b90509392505050565b6106e7610eee565b60006020836106f6919061179a565b1461072257602082610708919061179a565b602061071491906115df565b8261071f91906113be565b91505b81836020018181525050604051808452600081528281016020016040525082905092915050565b60178111610776576107708160058460ff16901b60ff161784610b1890919063ffffffff16565b50610889565b60ff81116107b85761079b601860058460ff16901b1784610b1890919063ffffffff16565b506107b281600185610b389092919063ffffffff16565b50610888565b61ffff81116107fb576107de601960058460ff16901b1784610b1890919063ffffffff16565b506107f581600285610b389092919063ffffffff16565b50610887565b63ffffffff811161084057610823601a60058460ff16901b1784610b1890919063ffffffff16565b5061083a81600485610b389092919063ffffffff16565b50610886565b67ffffffffffffffff81116108855761086c601b60058460ff16901b1784610b1890919063ffffffff16565b5061088381600885610b389092919063ffffffff16565b505b5b5b5b5b505050565b610896610eee565b6108a883846000015151848551610b5a565b905092915050565b6000306004546040516020016108c79291906111b2565b604051602081830303815290604052805190602001209050600454856060018181525050856005600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550807fb5e6e01e79f91267dc17b4e6314d5d4d03593d2ceee0fbb452b750bd70ea5af960405160405180910390a2600082600080886000015189602001518a604001518b606001518a8d60800151600001516040516024016109a59897969594939291906111de565b604051602081830303815290604052907bffffffffffffffffffffffffffffffffffffffffffffffffffffffff19166020820180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff83818316178352505050509050600260009054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16634000aea08887846040518463ffffffff1660e01b8152600401610a6393929190611263565b602060405180830381600087803b158015610a7d57600080fd5b505af1158015610a91573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ab59190610fbf565b610af4576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610aeb906112e5565b60405180910390fd5b600160046000828254610b0791906113be565b925050819055505095945050505050565b610b20610eee565b610b308384600001515184610c49565b905092915050565b610b40610eee565b610b51848560000151518585610ca0565b90509392505050565b610b62610eee565b8251821115610b7057600080fd5b84602001518285610b8191906113be565b1115610bb657610bb5856002610ba688602001518887610ba191906113be565b610d2e565b610bb09190611585565b610d4a565b5b600080865180518760208301019350808887011115610bd55787860182525b60208701925050505b60208410610c1c5780518252602082610bf791906113be565b9150602081610c0691906113be565b9050602084610c1591906115df565b9350610bde565b60006001856020036101000a03905080198251168184511681811785525050508692505050949350505050565b610c51610eee565b83602001518310610c7757610c768460028660200151610c719190611585565b610d4a565b5b8351805160208583010184815381861415610c93576001820183525b5050508390509392505050565b610ca8610eee565b84602001518483610cb991906113be565b1115610ce157610ce08560028685610cd191906113be565b610cdb9190611585565b610d4a565b5b6000600183610100610cf39190611467565b610cfd91906115df565b90508551838682010185831982511617815281518588011115610d205784870182525b505085915050949350505050565b600081831115610d4057829050610d44565b8190505b92915050565b600082600001519050610d5d83836106df565b50610d68838261088e565b50505050565b828054610d7a90611709565b90600052602060002090601f016020900481019282610d9c5760008555610de3565b82601f10610db557805160ff1916838001178555610de3565b82800160010185558215610de3579182015b82811115610de2578251825591602001919060010190610dc7565b5b509050610df09190610f08565b5090565b828054610e0090611709565b90600052602060002090601f016020900481019282610e225760008555610e70565b82601f10610e335780548555610e70565b82800160010185558215610e7057600052602060002091601f016020900482015b82811115610e6f578254825591600101919060010190610e54565b5b509050610e7d9190610f08565b5090565b6040518060a0016040528060008019168152602001600073ffffffffffffffffffffffffffffffffffffffff16815260200160007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916815260200160008152602001610ee8610eee565b81525090565b604051806040016040528060608152602001600081525090565b5b80821115610f21576000816000905550600101610f09565b5090565b6000610f38610f338461134a565b611325565b905082815260208101848484011115610f5457610f5361188c565b5b610f5f8482856116c7565b509392505050565b600081519050610f7681611964565b92915050565b600081359050610f8b8161197b565b92915050565b600082601f830112610fa657610fa5611887565b5b8135610fb6848260208601610f25565b91505092915050565b600060208284031215610fd557610fd4611896565b5b6000610fe384828501610f67565b91505092915050565b6000806040838503121561100357611002611896565b5b600061101185828601610f7c565b925050602083013567ffffffffffffffff81111561103257611031611891565b5b61103e85828601610f91565b9150509250929050565b61105181611613565b82525050565b61106081611631565b82525050565b61106f8161163b565b82525050565b60006110808261137b565b61108a8185611391565b935061109a8185602086016116d6565b6110a38161189b565b840191505092915050565b60006110b98261137b565b6110c381856113a2565b93506110d38185602086016116d6565b80840191505092915050565b6110f06110eb82611691565b61176c565b82525050565b600061110182611386565b61110b81856113ad565b935061111b8185602086016116d6565b6111248161189b565b840191505092915050565b600061113c6023836113ad565b9150611147826118c6565b604082019050919050565b600061115f6028836113ad565b915061116a82611915565b604082019050919050565b61117e81611687565b82525050565b61119561119082611687565b611790565b82525050565b60006111a782846110ae565b915081905092915050565b60006111be82856110df565b6014820191506111ce8284611184565b6020820191508190509392505050565b6000610100820190506111f4600083018b611048565b611201602083018a611175565b61120e6040830189611057565b61121b6060830188611048565b6112286080830187611066565b61123560a0830186611175565b61124260c0830185611175565b81810360e08301526112548184611075565b90509998505050505050505050565b60006060820190506112786000830186611048565b6112856020830185611175565b81810360408301526112978184611075565b9050949350505050565b600060208201905081810360008301526112bb8184611075565b905092915050565b600060208201905081810360008301526112dd81846110f6565b905092915050565b600060208201905081810360008301526112fe8161112f565b9050919050565b6000602082019050818103600083015261131e81611152565b9050919050565b600061132f611340565b905061133b828261173b565b919050565b6000604051905090565b600067ffffffffffffffff82111561136557611364611858565b5b61136e8261189b565b9050602081019050919050565b600081519050919050565b600081519050919050565b600082825260208201905092915050565b600081905092915050565b600082825260208201905092915050565b60006113c982611687565b91506113d483611687565b9250827fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff03821115611409576114086117cb565b5b828201905092915050565b6000808291508390505b600185111561145e5780860481111561143a576114396117cb565b5b60018516156114495780820291505b8081029050611457856118b9565b945061141e565b94509492505050565b600061147282611687565b915061147d83611687565b92506114aa7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff84846114b2565b905092915050565b6000826114c2576001905061157e565b816114d0576000905061157e565b81600181146114e657600281146114f05761151f565b600191505061157e565b60ff841115611502576115016117cb565b5b8360020a915084821115611519576115186117cb565b5b5061157e565b5060208310610133831016604e8410600b84101617156115545782820a90508381111561154f5761154e6117cb565b5b61157e565b6115618484846001611414565b92509050818404811115611578576115776117cb565b5b81810290505b9392505050565b600061159082611687565b915061159b83611687565b9250817fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff04831182151516156115d4576115d36117cb565b5b828202905092915050565b60006115ea82611687565b91506115f583611687565b925082821015611608576116076117cb565b5b828203905092915050565b600061161e82611667565b9050919050565b60008115159050919050565b6000819050919050565b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000819050919050565b600061169c826116a3565b9050919050565b60006116ae826116b5565b9050919050565b60006116c082611667565b9050919050565b82818337600083830152505050565b60005b838110156116f45780820151818401526020810190506116d9565b83811115611703576000848401525b50505050565b6000600282049050600182168061172157607f821691505b6020821081141561173557611734611829565b5b50919050565b6117448261189b565b810181811067ffffffffffffffff8211171561176357611762611858565b5b80604052505050565b60006117778261177e565b9050919050565b6000611789826118ac565b9050919050565b6000819050919050565b60006117a582611687565b91506117b083611687565b9250826117c0576117bf6117fa565b5b828206905092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b60008160601b9050919050565b60008160011c9050919050565b7f756e61626c6520746f207472616e73666572416e6443616c6c20746f206f726160008201527f636c650000000000000000000000000000000000000000000000000000000000602082015250565b7f536f75726365206d75737420626520746865206f7261636c65206f662074686560008201527f2072657175657374000000000000000000000000000000000000000000000000602082015250565b61196d81611625565b811461197857600080fd5b50565b61198481611631565b811461198f57600080fd5b5056fea2646970667358221220286a1a89e6bb9caa4cfa71e88bf0fd12e4e62e08fe45df2b4798bc691f4d9d3364736f6c63430008070033"

  }

const networkConfig = {
    default: {
        name: 'hardhat',
        fee: '100000000000000000',
        keyHash: '0x6c3699283bda56ad74f6b855546325b68d482e983852a7a82979cc4807b641f4',
        jobId: '29fa9aa13bf1468788b7cc4a500a45b8',
        fundAmount: "1000000000000000000",
        keepersUpdateInterval: "30"
    },

    31337: {
        name: 'localhost',
        fee: '100000000000000000',
        keyHash: '0x6c3699283bda56ad74f6b855546325b68d482e983852a7a82979cc4807b641f4',
        jobId: '29fa9aa13bf1468788b7cc4a500a45b8',
        fundAmount: "1000000000000000000",
        keepersUpdateInterval: "30"
    },
    42: {
        name: 'kovan',
        linkToken: '0xa36085F69e2889c224210F603D836748e7dC0088',
        ethUsdPriceFeed: '0x9326BFA02ADD2366b30bacB125260Af641031331',
        keyHash: '0x6c3699283bda56ad74f6b855546325b68d482e983852a7a82979cc4807b641f4',
        vrfCoordinator: '0xdD3782915140c8f3b190B5D67eAc6dc5760C46E9',
        oracle: '0xc57b33452b4f7bb189bb5afae9cc4aba1f7a4fd8',
        jobId: 'd5270d1c311941d0b08bead21fea7747',
        fee: '100000000000000000',
        fundAmount: "1000000000000000000",
        keepersUpdateInterval: "30"
    },
    4: {
        name: 'rinkeby',
        linkToken: '0x01be23585060835e02b77ef475b0cc51aa1e0709',
        ethUsdPriceFeed: '0x8A753747A1Fa494EC906cE90E9f37563A8AF630e',
        keyHash: '0x2ed0feb3e7fd2022120aa84fab1945545a9f2ffc9076fd6156fa96eaff4c1311',
        vrfCoordinator: '0xb3dCcb4Cf7a26f6cf6B120Cf5A73875B7BBc655B',
        oracle: '0xc57b33452b4f7bb189bb5afae9cc4aba1f7a4fd8',
        jobId: '6b88e0402e5d415eb946e528b8e0c7ba',
        fee: '100000000000000000',
        fundAmount: "1000000000000000000",
        keepersUpdateInterval: "30"
    },
    1: {
        name: 'mainnet',
        linkToken: '0x514910771af9ca656af840dff83e8264ecf986ca',
        fundAmount: "0",
        keepersUpdateInterval: "30"
    },
    5: {
        name: 'goerli',
        linkToken: '0x326c977e6efc84e512bb9c30f76e30c160ed06fb',
        fundAmount: "0"
    },
    80001: {
        name: 'mumbai',
        linkToken: '0x326C977E6efc84E512bB9C30f76E30c160eD06FB',
        ethUsdPriceFeed: '0x0715A7794a1dc8e42615F059dD6e406A6594651A',
        keyHash: '0x6e75b569a01ef56d18cab6a8e71e6600d6ce853834d4a5748b720d06f878b3a4',
        vrfCoordinator: '0x8C7382F9D8f56b33781fE506E897a4F1e2d17255',
        oracle: '0x58bbdbfb6fca3129b91f0dbe372098123b38b5e9',
        jobId: 'da20aae0e4c843f6949e5cb3f7cfe8c4',
        fee: '100000000000000',
        fundAmount: "100000000000000"
    },
    137: {
        name: 'polygon',
        linkToken: '0xb0897686c545045afc77cf20ec7a532e3120e0f1',
        ethUsdPriceFeed: '0xF9680D99D6C9589e2a93a78A04A279e509205945',
        keyHash: '0xf86195cf7690c55907b2b611ebb7343a6f649bff128701cc542f0569e2c549da',
        vrfCoordinator: '0x3d2341ADb2D31f1c5530cDC622016af293177AE0',
        oracle: '0x0a31078cd57d23bf9e8e8f1ba78356ca2090569e',
        jobId: '12b86114fa9e46bab3ca436f88e1a912',
        fee: '100000000000000',
        fundAmount: "100000000000000"
    },
}

const developmentChains = ["hardhat", "localhost"]

const getNetworkIdFromName = async (networkIdName) => {
    for (const id in networkConfig) {
        if (networkConfig[id]['name'] == networkIdName) {
            return id
        }
    }
    return null
}

const autoFundCheck = async (contractAddr, networkName, linkTokenAddress, additionalMessage) => {
    const chainId = await getChainId()
    console.log("Checking to see if contract can be auto-funded with LINK:")
    const amount = networkConfig[chainId]['fundAmount']
    //check to see if user has enough LINK
    const accounts = await ethers.getSigners()
    const signer = accounts[0]
    const LinkToken = await ethers.getContractFactory("LinkToken")
    const linkTokenContract = new ethers.Contract(linkTokenAddress, LinkToken.interface, signer)
    const balanceHex = await linkTokenContract.balanceOf(signer.address)
    const balance = await ethers.BigNumber.from(balanceHex._hex).toString()
    const contractBalanceHex = await linkTokenContract.balanceOf(contractAddr)
    const contractBalance = await ethers.BigNumber.from(contractBalanceHex._hex).toString()
    if (balance > amount && amount > 0 && contractBalance < amount) {
        //user has enough LINK to auto-fund
        //and the contract isn't already funded
        return true
    } else { //user doesn't have enough LINK, print a warning
        console.log("Account doesn't have enough LINK to fund contracts, or you're deploying to a network where auto funding isnt' done by default")
        console.log("Please obtain LINK via the faucet at https://" + networkName + ".chain.link/, then run the following command to fund contract with LINK:")
        console.log("npx hardhat fund-link --contract " + contractAddr + " --network " + networkName + additionalMessage)
        return false
    }
}

module.exports = {
    networkConfig,
    getNetworkIdFromName,
    autoFundCheck,
    developmentChains,
    chaincontractConfig
}
